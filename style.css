:root{
  --bg:#0e1320; --panel:#151b2f; --panel-2:#10162a; --accent:#6ee7ff; --accent-2:#a78bfa;
  --text:#eaf0ff; --muted:#9fb2d6; --shadow:0 10px 30px rgba(0,0,0,.35);
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
  background:linear-gradient(180deg,#0b1020,#0b1020 40%,#0a0f1a);
  color:var(--text)
}

/* Layout */
.app{display:grid; grid-template-columns:320px 1fr; height:100vh}
.sidebar{background:var(--panel); border-right:1px solid #1f2742; padding:16px; overflow:auto}
.room-wrap{display:grid; grid-template-rows:1fr auto; height:100vh;}
.room{
  position:relative;
  background:radial-gradient(1200px 700px at 50% 80%, #0c142a, #0b1020),
             url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40"><circle cx="20" cy="20" r="2" fill="%23223355"/></svg>');
  background-size:auto,40px;
  overflow:hidden
}
.floor{
  position:absolute; inset:auto 0 0; height:160px;
  background:radial-gradient(60% 100% at 50% 100%, #0f1a3a 0%, #0b1020 70%);
  filter:blur(.5px)
}

/* Sidebar bits */
.h{font-size:18px; font-weight:700; letter-spacing:.3px; margin:8px 0 6px}
.muted{color:var(--muted); font-size:12px}
.section{background:var(--panel-2); border:1px solid #1b2340; border-radius:16px; padding:12px; margin:10px 0; box-shadow:var(--shadow)}
.row{display:flex; align-items:center; gap:8px; margin:6px 0; flex-wrap:wrap}
.color-swatch{width:24px; height:24px; border-radius:999px; border:1px solid #0005; cursor:pointer}
.option{padding:6px 10px; border:1px solid #1b2340; border-radius:999px; cursor:pointer; background:#0c1225; color:var(--text)}
.option.active, .color-swatch.active{outline:2px solid var(--accent)}

/* Avatars */
.avatar{
  position:absolute;
  width:240px;
  height:270px;
  transform:translate(-50%, -90%);
  cursor:pointer;
  transition:transform .15s
}
.avatar .name{
  position:absolute;
  bottom:100%;
  left:50%;
  transform:translate(-50%, -8px);
  font-size:12px;
  text-shadow:0 1px 2px #000;
  white-space:nowrap;
}
.avatar:hover{transform:translate(-50%, -92%) scale(1.02)}
.bubble{
  position:absolute;
  bottom:110%;
  left:50%;
  transform:translate(-50%,0);
  background:#10192e;
  border:1px solid #1e2a50;
  border-radius:12px;
  padding:6px 8px;
  font-size:12px;
  box-shadow:var(--shadow)
}

/* Hover card (PM / TicTacToe / Profile) */
.hover-card{
  position:absolute;
  top:-110px;
  left:50%;
  transform:translateX(-50%);
  background:#0f172a;
  border:1px solid #1b2340;
  border-radius:14px;
  padding:8px;
  display:none;
  gap:6px;
  box-shadow:var(--shadow)
}
.avatar:hover .hover-card{display:flex}
.btn{
  padding:6px 10px;
  border-radius:10px;
  border:1px solid #1b2340;
  background:#0c1225;
  color:var(--text);
  cursor:pointer
}

/* Chat dock */
.dock{
  display:grid;
  grid-template-columns:1fr auto;
  gap:10px;
  padding:12px;
  background:linear-gradient(180deg, #0b1120, #0a0f1d);
  border-top:1px solid #1b2340
}
.chat{display:flex; gap:8px}
.chat input{
  flex:1;
  padding:10px 12px;
  border-radius:12px;
  border:1px solid #1b2340;
  background:#0c1225;
  color:var(--text)
}
.chat .send{padding:10px 14px}
.feed{
  max-height:30vh;
  overflow:auto;
  padding:12px;
  border:1px solid #1b2340;
  border-radius:12px;
  background:#0c1225
}
.msg{margin:4px 0; font-size:13px}
.msg .u{color:var(--accent)}
.msg.pm .u{color:var(--accent-2)}

/* Modals & Tic-Tac-Toe */
dialog{
  border:none;
  border-radius:16px;
  padding:0;
  box-shadow:var(--shadow);
  background:#0c1225;
  color:var(--text)
}
dialog::backdrop{background:rgba(0,0,0,.55)}
.modal{padding:16px; min-width:300px}
.ttt{
  display:grid;
  grid-template-columns:repeat(3, 80px);
  gap:8px;
  justify-content:center;
  margin-top:8px
}
.ttt button{
  width:80px;
  height:80px;
  font-size:28px;
  border-radius:12px;
  border:1px solid #1b2340;
  background:#0f172a;
  color:var(--text);
  cursor:pointer
}

/* Badge */
.youBadge{
  font-size:10px;
  color:#94a3b8;
  border:1px solid #223;
  padding:2px 6px;
  border-radius:999px;
  margin-left:6px
}

/* Responsive */
@media(max-width:980px){
  .app{grid-template-columns:1fr}
  .sidebar{order:2; height:48vh}
  .room-wrap{order:1}
}
.hidden{
  display:none !important;
}

/* PNG avatar sprite layout */
.avatar-sprite {
  position: relative;
  width:240px;
  height:270px;
  margin:0 auto;
}

.avatar-sprite img {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  object-fit: contain;
  pointer-events: none;
}
